/**
 * The MIT License (MIT)
 *
 * Copyright (c) 2016 France Télévisions
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
 * documentation files (the "Software"), to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
 * to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of
 * the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
 * THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

angular.module("ftv.services.httpRequestTracker",[]).service("httpRequestTracker",["$http",function(t){this.hasPendingRequests=function(){return t.pendingRequests.length>0}}]),angular.module("ftv.components.touchEvents",["ftv.services.httpRequestTracker"]).directive("ngTouchStart",function(){return{link:function(t,n){function e(){var e=n.attr("ng-touch-start");t.$apply(e)}n.bind("touchstart",e)}}}).directive("ngTouchFinish",function(){return{link:function(t,n){function e(){var e=n.attr("ng-touch-finish");t.$apply(e)}n.bind("touchend touchcancel",e)}}}).directive("ngActiveOnClick",["$timeout","httpRequestTracker",function(t,n){return{link:function(e,i,c){function u(){a=!0}function r(){if(a)return void(a=!1);a=!1,i.addClass("active");var n=i.find("a");n&&n.trigger("click");var e=c.ngActiveOnClick;return e?"pending"===e?o():void(isNaN(parseInt(e))||t(function(){i.removeClass("active")},e)):void 0}function o(){t(function(){return n.hasPendingRequests()?o():void i.removeClass("active")},"500")}var a=!1;i.bind("touchmove",u),i.bind("touchend touchcancel",r),i.bind("mouseup",r)}}}]);